<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/src/css/global.css" />
  <link rel="stylesheet" href="/src/css/modelo.css" />
  <link rel="stylesheet" href="/src/css/categoria.css">
  <link rel="icon" href="/src/images/logo-principal.png" />
  <title>ADM - Cadastro de Categoria</title>
</head>

<body>

  <div class="principalcontainer">
    <!-- MENU LATERAL -->
    <aside class="aside">
      <div class="cont-aside">
        <h1>Admin</h1>

        <div class="flex-menu-aside">
          <div class="icon-circle"></div>
          <p><a href="/src/painel.html">Início</a></p>
        </div>

        <div class="accordion">
          <div class="flex-menu-aside accordion-header">
            <div class="icon-circle"></div>
            <p>Produtos</p>
          </div>
          <div class="accordion-body">
            <div class="flexnormal">
              <div class="icon-circle"></div>
              <p><a href="/src/cadastroprodutos.html" style="font-size: medium;">Cadastrar Produto</a></p>
            </div>
            <div class="flexnormal">
              <div class="icon-circle"></div>
              <p><a href="/src/listadeprodutos.html">Lista de Produtos</a></p>
            </div>

          </div>

          <!-- Categoria -->

          <div class="accordion">
            <div class="flex-menu-aside accordion-header">
              <div class="icon-circle"></div>
              <p>Categoria</p>
            </div>
            <div class="accordion-body">
              <div class="flexnormal">
                <div class="icon-circle"></div>
                <p><a href="/src/cadastrocategoria.html" style="font-size: medium;">Cadastrar Categoria</a></p>
              </div>
              <div class="flexnormal">
                <div class="icon-circle"></div>
                <p><a href="/src/listadecategoria.html" style="font-size: medium;">Lista de Categorias</a></p>
              </div>
            </div>


            <!-- Administradores -->

            <div class="accordion">
              <div class="flex-menu-aside accordion-header">
                <div class="icon-circle"></div>
                <p>Administradores</p>
              </div>
              <div class="accordion-body">
                <div class="flexnormal">
                  <div class="icon-circle"></div>
                  <p><a href="/src/cadastrodeadm.html">Cadastrar</a></p>
                </div>
                <div class="flexnormal">
                  <div class="icon-circle"></div>
                  <p><a href="/src/listadeadm.html">Listagem</a></p>
                </div>
              </div>

            </div>

            <hr style="border-color: #fff4; width: 100%; margin: 20px 0;" />

            <div class="cont-aside">
              <h1>Gerenciar</h1>

              <div class="flex-menu-aside">
                <div class="icon-circle"></div>
                <p>Analitycs</p>
              </div>

              <div class="flex-menu-aside">
                <div class="icon-circle"></div>
                <p>Usuários</p>
              </div>

              <div class="flex-menu-aside">
                <div class="icon-circle"></div>
                <p>Vendas</p>
              </div>

            </div>
          </div>
    </aside>

    <!-- CONTEÚDO CENTRAL -->
    <section class="aside-direito">

      <!-- TOPO -->
      <header>
        <div class="flex-ok">
          <img src="/src/images/lgo-menu.svg" alt="Logo" />
          <h3>
            Bem vindo!<br />
            <strong>Administrador</strong>
          </h3>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
          <img src="/src/images/logout-rounded.png" alt="Logout" />
          <p>Sair</p>
        </div>
      </header>

      <!-- CONTEÚDO PRINCIPAL -->
      <main class="conteudo-categoria">
        <h1>Cadastro de Categoria</h1>
        <form id="form-categoria">
          <label for="categoria"></label>
          <input type="text" name="categoria" id="categoria" placeholder="Nome da Categoria" required>
          <br>
          <input type="submit" value="Cadastrar" class="submit-categoria">
        </form>

      </main>

    </section>

  </div>
  <script src="/src/javascript/accordion.js"></script>
  <script>
    document.getElementById('form-categoria').addEventListener('submit', function (event) {
      event.preventDefault(); // Previne o envio padrão do formulário

      const categoriaInput = document.getElementById('categoria');
      const categoria = categoriaInput.value.trim();

      if (!categoria) {
        alert('Por favor, insira o nome da categoria.');
        return;
      }

      fetch('php/cadastro_categoria.php', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: `categoria=${categoria}`
      })
        .then(res => res.text())  // Vamos capturar a resposta como texto (não JSON, para diagnóstico)
        .then(data => {
          console.log(data);  // Verifique o que foi retornado pelo PHP
          try {
            const jsonData = JSON.parse(data);  // Tentamos fazer o parse para JSON
            if (jsonData.status === 'sucesso') {
              alert(jsonData.mensagem);
              categoriaInput.value = '';
            } else {
              alert(jsonData.mensagem);
            }
          } catch (err) {
            alert('Erro ao tentar processar a resposta.');
            console.error('Erro ao processar a resposta:', err);
          }
        })
        .catch(err => {
          alert('Erro no envio do formulário.');
          console.error('Erro no envio do formulário:', err);
        });
    });
  </script>
</body>

</html>